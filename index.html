<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DeepSeek API Example</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      margin: 0; padding: 20px;
      min-height: 100vh;
      display: flex; justify-content: center; align-items: center;
    }
    .container {
      background: rgba(255,255,255,0.95);
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 15px 35px rgba(0,0,0,0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.2);
      max-width: 800px; width: 100%;
    }
    h1 { text-align: center; color: #333; margin-bottom: 30px; font-size: 2.5em; background: linear-gradient(135deg,#667eea,#764ba2); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
    .input-group { margin-bottom: 25px; }
    label { display:block; margin-bottom:8px; font-weight:600; color:#333; font-size:1.1em; }
    textarea { width: 100%; padding: 15px; border: 2px solid #e0e0e0; border-radius: 12px; font-family: inherit; font-size:16px; box-sizing:border-box; min-height:120px; resize: vertical; }
    textarea:focus { outline:none; border-color:#667eea; box-shadow:0 0 0 3px rgba(102,126,234,0.1); }
    .send-btn { background:linear-gradient(135deg,#667eea,#764ba2); color:white; padding:15px 30px; border:none; border-radius:25px; font-size:16px; font-weight:600; cursor:pointer; display:block; margin:0 auto 30px; min-width:150px; transition: all 0.3s ease; }
    .send-btn:hover:not(:disabled) { transform:translateY(-2px); box-shadow:0 8px 25px rgba(102,126,234,0.3); }
    .send-btn:disabled { opacity:0.6; cursor:not-allowed; transform:none; }
    .response { margin-top:25px; padding:20px; border-radius:12px; white-space:pre-wrap; line-height:1.6; font-size:15px; }
    .response.success { background-color:#f8f9fa; border:1px solid #e9ecef; color:#333; }
    .response.error { background-color:#f8d7da; color:#721c24; border:1px solid #f5c6cb; }
    .response.loading { background-color:#d1ecf1; color:#0c5460; border:1px solid #bee5eb; position:relative; }
    .response.loading::after { content:''; display:inline-block; width:20px; height:20px; border:2px solid #0c5460; border-radius:50%; border-top-color:transparent; animation:spin 1s ease-in-out infinite; margin-left:10px; vertical-align:middle; }
    @keyframes spin { to { transform:rotate(360deg); } }
    @media (max-width:768px){ body{padding:10px;} .container{padding:20px;} h1{font-size:2em;} textarea{min-height:100px;} }
  </style>
</head>
<body>
  <div class="container">
    <h1>DeepSeek API Test</h1>

    <div class="input-group">
      <label for="prompt">Your Message:</label>
      <textarea id="prompt" placeholder="Enter your message here...">Hello, how are you?</textarea>
      <small>Press Enter to send, or Shift+Enter for new line</small>
    </div>

    <button onclick="callDeepSeekAPI()" class="send-btn">Send Request</button>

    <div id="response"></div>
  </div>

  <script>
    async function callDeepSeekAPI() {
      const prompt = document.getElementById('prompt').value.trim();
      const responseDiv = document.getElementById('response');
      const button = document.querySelector('button');

      if (!prompt) {
        responseDiv.innerHTML = '<div class="response error">Please enter a message</div>';
        return;
      }

      button.disabled = true;
      button.textContent = 'Sending...';
      responseDiv.innerHTML = '<div class="response loading">Calling DeepSeek API...</div>';

      try {
        const res = await fetch('/.netlify/functions/queryDeepSeek', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ prompt })
        });

        const data = await res.json();

        if (data.error) throw new Error(data.error);

        const aiResponse = data.choices?.[0]?.message?.content || 'No response';
        responseDiv.innerHTML = `<div class="response success">${aiResponse.replace(/\n/g,'<br>')}</div>`;
      } catch (err) {
        responseDiv.innerHTML = `<div class="response error">Error: ${err.message}</div>`;
      } finally {
        button.disabled = false;
        button.textContent = 'Send Request';
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('prompt').addEventListener('keydown', e => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          callDeepSeekAPI();
        }
      });
    });
  </script>
</body>
</html>
